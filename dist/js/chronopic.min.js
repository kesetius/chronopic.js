!function(){function e(e){return"object"==typeof e&&e}function t(e){return"number"==typeof e&&!isNaN(e)&&Math.abs(e)<1/0}function n(t,n){e(t)||(t={});for(var a in n)t.hasOwnProperty(a)||(t[a]=n[a]);return t}function a(e,t){t=n(t,{appendTo:null,context:document,html:"",insertAfter:null,insertBefore:null,replace:null});var a,o,r=e instanceof HTMLElement?e:null;if("string"==typeof e){o=function(e,t){return e.match(/(\[[^\]]+\]|#[^#.\[]+|\.[^#.\[]+|\w+)/g).forEach(function(e){"["==e[0]?(e=e.match(/^\[([^=\]]+)=?([^\]]+)?\]$/))&&(t.attribs[e[1]]=e[2]||""):"."==e[0]?t.classes.push(e.substr(1)):"#"==e[0]?t.attribs.id=e.substr(1):t.tag=e}),t}(e,{attribs:{},classes:[]}),r=t.context.createElement(o.tag),o.classes.forEach(function(e){r.classList.add(e)});for(a in o.attribs)o.attribs.hasOwnProperty(a)&&r.setAttribute(a,o.attribs[a])}(this.element=r).innerHTML=t.html,this.parent=null,this.events={},t.replace?t.replace.parentNode.replaceChild(r,t.replace):t.appendTo?(this.parent=t.appendTo).element.appendChild(r):t.insertAfter?t.insertAfter.parentNode.insertBefore(r,t.insertAfter.nextSibling):t.insertBefore&&t.insertBefore.parentNode.insertBefore(r,t.insertBefore)}function o(e){return{compare:function(t){var n,a=0,o=["getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds"];for(n in o){if(e[o[n]]()!=t[o[n]]())break;a=++n}return a},get days(){return new Date(e.getFullYear(),e.getMonth()+1,0).getDate()},get firstDay(){return new Date(e.getFullYear(),e.getMonth(),1).getDay()},get week(){var t=new Date(e);return t.setHours(0,0,0),t.setDate(t.getDate()+4-(t.getDay()||7)),Math.ceil(((t-new Date(t.getFullYear(),0,1))/864e5+1)/7)}}}function r(e,t){return new a(e,t)}function i(e,t,n){var a=e.getDate(),r=e.getMonth(),i=e.getFullYear(),s=e.getHours(),c=e.getMinutes(),l=e.getSeconds(),h=o(e).week,u=e.getDay(),d=12>s?"㏂":"㏘";return t.replace(/{ww}/gi,("0"+h).slice(-2)).replace(/{w}/gi,h).replace(/{DDDD}/g,n.dayOfWeek[u]).replace(/{DDD}/g,n.dayOfWeekShort[u]).replace(/{DD}/g,("0"+a).slice(-2)).replace(/{D}/g,a).replace(/{MMMM}/g,n.monthName[r]).replace(/{MMM}/g,n.monthNameShort[r]).replace(/{MM}/g,("0"+(r+1)).slice(-2)).replace(/{M}/g,r+1).replace(/{YYYY}/g,i).replace(/{YY}/g,i.toString().slice(-2)).replace(/{HH}/g,("0"+s).slice(-2)).replace(/{H}/g,s).replace(/{hh}/g,("0"+s%12).slice(-2)).replace(/{h}/g,s%12).replace(/{mm}/g,("0"+c).slice(-2)).replace(/{m}/g,c).replace(/{ss}/g,("0"+l).slice(-2)).replace(/{s}/g,l).replace(/{ap}/g,d)}function s(e,t){var n,a,r=o(new Date(e,t)).firstDay||7,i=new Date(e,t,1-(r-1||7)),s=[];for(n=0;6>n;++n)for(s.push([]),a=0;7>a;++a)s[n].push(new Date(i)),i.setDate(i.getDate()+1);return s}function c(e){var t,n,a=[];for(t=0;3>t;++t)for(a.push([]),n=0;4>n;++n)a[t].push(new Date(e,4*t+n));return a}function l(a,h){function u(e,n,a){for(var r,i=d.min,s=d.max;a>(r=o(new Date(e,n,a)).days);)++n,a-=a-r;for(;n>12;)++e,n-=12;if(t(e)){if(t(i.year)&&e<i.year||t(s.year)&&e>s.year)return!1;if(t(n)){if(t(i.month)&&n<i.month&&e<=i.year||t(s.month)&&n>s.month&&e>=s.year)return!1;if(t(a)&&(t(i.day)&&a<i.day&&n<=i.month&&e<=i.year||t(s.day)&&a>s.day&&n>=s.month&&e>=s.year))return!1}}return!0}h=n(h,{className:"chronopic",date:null,format:"{YYYY}-{MM}-{DD}",locale:null,max:{year:2100},min:{year:1900},onChange:null}),this.instances=[],this.i18n=l.i18n.en_GB,this.max=e(h.max)?h.max:{},this.min=e(h.min)?h.min:{};var d=this,f=new Date;e(h.date)&&(f=(f=h.date)instanceof Date?new Date(f):new Date(f.year,f.month-1,f.day)),d.max instanceof Date&&(d.max={year:d.max.getFullYear(),month:d.max.getMonth()+1,day:d.max.getDate()}),d.min instanceof Date&&(d.min={year:d.min.getFullYear(),month:d.min.getMonth()+1,day:d.min.getDate()}),("string"==typeof a?Array.prototype.slice.call(document.querySelectorAll(a)):[a]).forEach(function(n){if(n instanceof HTMLElement){l.instances.forEach(function(e){e.instances.forEach(function(e,t,a){e.element.element==n&&(e.element.on(["click","change","keydown"],null),a.splice(t,1))})});var a=n.nextSibling;"DIV"==a.tagName&&a.classList.contains(h.className)||(a=null);var d,m=h.className,g=r("div."+m,{insertAfter:n,replace:a}),p=this,y={};["day","month"].forEach(function(e){g.add(y[e]=r("table.hidden."+e)),y[e].head=r("thead",{appendTo:y[e]}),y[e].body=r("tbody",{appendTo:y[e]})}),p.instances.push(d={date:new Date(f),container:g,element:r(n),selected:{},tables:y,value:"",visible:!1,get day(){return this.date.getDate()},set day(e){u(this.date.getFullYear(),this.date.getMonth()+1,e)&&(this.date.setDate(e),this.selected.day=new Date(this.date))},hide:function(){for(var e in y)y[e].classes.add("hidden");return this.visible=!1,this.selected.month=null,this.selected.day&&(this.date=new Date(this.selected.day),this.selected.month=new Date(this.date)),this},get hour(){return this.date.getHours()},set hour(e){this.date.setHours(e)},get minute(){return this.date.getMinutes()},set minute(e){this.date.setMinutes(e)},get month(){return this.date.getMonth()},set month(e){u(this.date.getFullYear(),e+1)&&(this.date.setMonth(e),this.selected.month=new Date(this.date))},rebuild:function(e){var n,a,l=this,h=l.selected,d=new Date,f=1;if(!e||"day"==e){for(l.tables.day.head.add([r("tr.title").add([r("th.prev[title="+p.locale.prevMonth+"]",{html:"&lt;"}).on("click",function(e){l.date.setDate(1),l.month--,l.show("day"),e.stopPropagation()}),r("th[colspan=6][title="+p.locale.selectMonth+"]",{html:i(l.date,p.locale.formatMonth,p.locale)}).on("click",function(){l.show("month")}),r("th.next[title="+p.locale.nextMonth+"]",{html:"&gt;"}).on("click",function(e){l.date.setDate(1),l.month++,l.show("day"),e.stopPropagation()})]),n=r("tr.labels").add(r("th.week",{html:p.locale.week}))],!0),a=0;7>a;++a)n.add(r("th.day[title="+p.locale.dayOfWeek[f%7]+"]",{html:p.locale.dayOfWeekShort[f++%7]}));l.tables.day.body.clear(),s(l.year,l.month).forEach(function(e){var t=r("tr",{appendTo:l.tables.day.body});t.add(r("td.week",{html:o(e[0]).week})),e.forEach(function(e){var n,a=".day",s=e.getMonth()-l.month,c=!u(e.getFullYear(),e.getMonth()+1,e.getDate());(-1==s||11==s)&&(a+=".prev"),(1==s||-11==s)&&(a+=".next"),h.day&&o(h.day).compare(e)>=3&&(a+=".selected"),c&&(a+=".disabled"),o(e).compare(d)>=3&&(a+=".now"),t.add(n=r("td[title="+i(e,p.locale.formatDay,p.locale)+"]"+a,{html:e.getDate()})),!c&&n.on("click",function(){l.month=e.getMonth(),l.day=e.getDate(),l.update().hide()})})})}return e&&"month"!=e||(l.tables.month.head.add([r("tr.title").add([r("th.prev[title="+p.locale.prevYear+"]",{html:"&lt;"}).on("click",function(e){l.year--,l.show("month"),e.stopPropagation()}),r("th.year[colspan=6][title="+p.locale.year+"]").add(r("input[type=number][step=1][min="+(p.min.year||0)+"][max="+(p.max.year||9999)+"][value="+l.year+"]").on("change",function(e,n){t(n=Number(e.target.value))&&(l.year=n,l.show("month"))})),r("th.next[title="+p.locale.nextYear+"]",{html:"&gt;"}).on("click",function(e){l.year++,l.show("month"),e.stopPropagation()})])],!0),l.tables.month.body.clear(),c(l.year).forEach(function(e){var t=r("tr",{appendTo:l.tables.month.body});e.forEach(function(e){var n,a=".month",i=e.getMonth(),s=!u(e.getFullYear(),i+1);h.month&&o(h.month).compare(e)>=2&&(a+=".selected"),s&&(a+=".disabled"),o(e).compare(d)>=2&&(a+=".now"),t.add(n=r("td[colspan=2][title="+p.locale.monthName[i]+"]"+a,{html:p.locale.monthNameShort[i]})),!s&&n.on("click",function(){l.date.setDate(1),l.month=i,l.show("day")})})})),this},get second(){return this.date.getSeconds()},set second(e){this.date.setSeconds(e)},show:function(e){e||(e="day"),this.rebuild(e),this.visible=!0;for(var t in y)y.hasOwnProperty(t)&&y[t].classes[t==e?"remove":"add"]("hidden");var a=this.container.element,o=n;a.style.top=o.offsetTop+o.offsetHeight+"px",a.style.left=o.offsetLeft+"px",a.offsetWidth!=o.offsetWidth&&(a.style.width=o.offsetWidth+"px")},update:function(){return this.value=n.value=i(this.date,h.format,p.i18n),this.selected.day=new Date(this.date),"function"==typeof h.onChange&&h.onChange(n,this.date),this},get year(){return this.date.getFullYear()},set year(e){u(e)&&this.date.setFullYear(e)}}),e(h.date)&&d.update()||(n.value=""),d.element.on("click",function(e){d[d.visible?"hide":"show"]()}).on("keydown",function(e){var t,n,a,o=e.keyCode,r=e.target.selectionStart,s=e.target.value,c=0,l=[];37>o||o>40||(h.format.match(/(\{[^}]*\}|[^{]+)/g).forEach(function(e,t,a){n=e.length,/^\{(.*)\}$/.test(e)&&l.push({seg:e,beg:c,end:c+(n=++t<a.length?s.slice(c,s.indexOf(a[t],c)).length:s.slice(c).length)}),c+=n}),l.forEach(function(n,c,l){!t&&r>=n.beg&&r<=n.end&&(e.target.selectionEnd==r?(r=n.beg,t=n.end):37==o?(r=--c>=0?l[c].beg:n.beg,t=c>=0?l[c].end:n.end):39==o?(r=++c<l.length?l[c].beg:n.beg,t=c<l.length?l[c].end:n.end):((a=38==o)||40==o)&&(r=n.beg,t=n.end,n=n.seg,a=a?1:-1,/D{1,2}/.test(n)?d.day+=a:/M{1,4}/.test(n)?d.month+=a:/YY(YY)?/.test(n)?d.year+=a:/HH?/i.test(n)?d.hour+=a:/mm?/.test(n)?d.minute+=a:/ss?/.test(n)&&(d.second+=a),t+=i(d.date,n,p.i18n).length-s.slice(r,t).length,d.update(),d.visible&&d.show()))}),e.preventDefault(),e.target.selectionStart=r,e.target.selectionEnd=t||r)}).on("change",function(e){var n,a,o,r,i,s,c,l=e.target.value,u=0,f=!0;return h.format.match(/(\{[^}]*\}|[^{]+)/g).forEach(function(e,t,h){if(f)if(/^\{(.*)\}$/.test(e)){var d=l.slice(u);++t<h.length&&(d=d.slice(0,d.search(h[t]))),u+=d.length,e=e.slice(1,-1),"DD"==e||"D"==e?n=Number(d):"MMMM"==e?(p.i18n.monthName.forEach(function(e,t){!a&&d==e&&(a=t+1)}),a||(f=!1)):"MMM"==e?(p.i18n.monthNameShort.forEach(function(e,t){!a&&d==e&&(a=t+1)}),a||(f=!1)):"MM"==e||"M"==e?a=Number(d):"YYYY"==e||"YY"==e?o=Number(d):"HH"==e||"H"==e||"hh"==e||"h"==e?r=Number(d):"mm"==e||"m"==e?i=Number(d):"s"==e||"s"==e?s=Number(d):"ap"==e?"㏂"!=(c=d)&&"㏘"!=c&&(f=!1):f=!1}else l.substr(u,e.length)==e?u+=e.length:f=!1}),f?(t(s)&&(d.second=s),t(i)&&(d.minute=i),t(r)&&(d.hour=r),t(n)&&(d.day=n),t(a)&&(d.month=a-1),t(o)&&(d.year=o),d.update(),void(d.visible&&d.show())):void(e.target.value=d.value)}),document.addEventListener("click",function(e,t){for(;t=t?t.parentNode:e.target;)if(t==n||t==g.element)return;d.hide()})}},this),this.locale=h.locale||(navigator?(navigator.userLanguage||navigator.language).replace("-","_"):null),l.instances.push(this)}return a.prototype={add:function(e,t){return t===!0&&this.clear(),(e instanceof Array?e:[e]).forEach(function(e){this.element.appendChild(e.element),e.parent=this},this),this},get classes(){return this.element.classList},clear:function(){for(var e,t=this.element;e=t.firstChild;)t.removeChild(e);return this},on:function(e,t){return(e instanceof Array?e:[e]).forEach(function(e){var n=this,a="function"==typeof t?function(e){return t.call(n,e)}:null;n.events[e]instanceof Array||(n.events[e]=[]),a?(n.events[e].push(a),n.element.addEventListener(e,a)):(n.events[e].forEach(function(t){n.element.removeEventListener(e,t)}),n.events[e]=[])},this),this}},l.instances=[],l.prototype={get locale(){return this.i18n},set locale(e){l.i18n[e]&&l.i18n[e]!==this.i18n&&(this.i18n=l.i18n[e],this.instances.forEach(function(e){e.selected.day&&(e.day=e.date.getDate()),e.rebuild()}))}},l.i18n={en_GB:{dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayOfWeekShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],disabled:"Disabled",formatDay:"{DDDD} {D} {MMMM} {YYYY}",formatMonth:"{MMMM} {YYYY}",month:"Month",monthName:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNameShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],nextMonth:"Next month",nextYear:"Next year",prevMonth:"Previous month",prevYear:"Previous year",selectMonth:"Select month",week:"Week",year:"Year"}},"undefined"!=typeof window&&(window.addEventListener("resize",function(e){l.instances.forEach(function(e){e.instances.forEach(function(e){e.visible&&e.show()})})}),window.Chronopic=l),"object"==typeof module&&module.exports&&(module.exports=l),l}();